---
jobs:
- name: test-unboxit-nosequelgen
  plan:
  - get: ci
  - get: every-1h
    trigger: true
  - get: unboxit-nosequelgen
    trigger: true
  - task: snyk-test
    file: ci/concourse-ci/tasks/snyk-test/task.yml
    input_mapping: {source-code: unboxit-nosequelgen}
    params:
      SNYK_TOKEN: {{snyk-token}}
      USER_ID: {{snyk-user-id}}

- name: test-unboxit-elming
  plan:
  - get: ci
  - get: every-1h
    trigger: true
  - get: unboxit-elming
    trigger: true
  - task: npm-test
    file: ci/concourse-ci/tasks/npm-test/task.yml
    input_mapping: {source-code: unboxit-elming}
  - task: snyk-test
    file: ci/concourse-ci/tasks/snyk-test/task.yml
    input_mapping: {source-code: unboxit-elming}
    params:
      SNYK_TOKEN: {{snyk-token}}
      USER_ID: {{snyk-user-id}}

- name: test-unboxit-tdd-es6-babel-jest
  plan:
  - get: ci
  - get: every-1h
    trigger: true
  - get: unboxit-tdd-es6-babel-jest
    trigger: true
  - task: npm-test
    file: ci/concourse-ci/tasks/npm-test/task.yml
    input_mapping: {source-code: unboxit-tdd-es6-babel-jest}
  - task: snyk-test
    file: ci/concourse-ci/tasks/snyk-test/task.yml
    input_mapping: {source-code: unboxit-tdd-es6-babel-jest}
    params:
      SNYK_TOKEN: {{snyk-token}}
      USER_ID: {{snyk-user-id}}


resources:
- name: ci
  type: git
  source:
    uri: git@github.com:gdumitrescu/testing-ci.git
    branch: master
    private_key: {{private-key}}

- name: every-1h
  type: time
  source:
    interval: 1h
    location: America/Toronto

- name: unboxit-nosequelgen
  type: git
  source:
    uri: git@github.com:unboxit/nosequelgen.git
    branch: master
    private_key: {{private-key}}

- name: unboxit-elming
  type: git
  source:
    uri: git@github.com:unboxit/elming.git
    branch: master
    private_key: {{private-key}}

- name: unboxit-tdd-es6-babel-jest
  type: git
  source:
    uri: git@github.com:unboxit/tdd-es6-babel-jest.git
    branch: master
    private_key: {{private-key}}
